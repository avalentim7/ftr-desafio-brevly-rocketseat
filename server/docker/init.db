-- 1. Criação do banco de dados (rode este comando fora do banco atual, ex: via psql)
CREATE DATABASE brevly_db;

-- 2. Extensões necessárias
CREATE EXTENSION IF NOT EXISTS "pgcrypto"; -- para gen_random_uuid()
CREATE EXTENSION IF NOT EXISTS "uuid-ossp"; -- para uuid_generate_v4()

-- 3. Tabela principal: links
CREATE TABLE IF NOT EXISTS links (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  original_url TEXT NOT NULL,
  slug VARCHAR(50) NOT NULL UNIQUE,
  access_count INTEGER NOT NULL DEFAULT 0,
  created_at TIMESTAMP WITHOUT TIME ZONE NOT NULL DEFAULT NOW()
);

-- 4. Índices para performance
CREATE INDEX IF NOT EXISTS idx_links_created_at ON links (created_at DESC, id DESC);

-- 5. Teste de inserção
INSERT INTO links (original_url, slug) VALUES ('https://rocketseat.com.br', 'ignite');
